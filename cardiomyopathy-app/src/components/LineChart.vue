<template>
	<h1>Line Chart</h1>
	<input type="file" @change="onFileUpload" accept=".csv">
	<button @click="handleClick" >Generate Chart</button>

	<apexchart
		type="line"
		height="350"
		width="500"
		:options="chartOptions"
		:series="series"
	></apexchart>
</template>

<script>
import useParseCsvToJson from '../composables/useParseCsvToJson'
import { ref } from 'vue'

export default {
	setup() {
		const { onFileUpload, data } = useParseCsvToJson()

		const showChart = ref(true)

		const chartOptions = ref({
      chart: {
        height: 350,
        type: "line",
        zoom: {
          enabled: false,
        },
      },
      dataLabels: {
        enabled: false,
      },
      stroke: {
        curve: "straight",
      },
      title: {
        text: "Product Trends by Month",
        align: "left",
      },
      grid: {
        row: {
          colors: ["#f3f3f3", "transparent"], // takes an array which will be repeated on columns
          opacity: 0.5,
        },
      },
      // the data that goes onto the X- axis
      xaxis: {
				type: 'numeric',
        min: 0.0,
        max: 2.0,
        range: 2,
        tickAmount: 5
      },
      // the text on the y axis
      yaxis: {
        title: {
          text: "Sarcomere Length",
        },
				min: 0,
				max: 2,
				tickAmount: 5
      },
      // the colours and text displayed on the top right of the chart
      legend: {
        position: "top",
        horizontalAlign: "right",
        floating: true,
        offsetY: -25,
        offsetX: -5,
      },
    });

    let object1 = {
      name: 'Test',
      data: [[0.0042,1.4129],[0.008,1.40646],[0.01725,1.38387],[0.02105,1.36841],[0.0248,1.35099],[0.02846,1.33548],[0.03227,1.32371],[0.03965,1.30645],[0.04347,1.29594],[0.05085,1.27097],[0.05281,1.26368],[0.05844,1.24156],[0.06206,1.22581],[0.06767,1.19032],[0.06779,1.18904],[0.07143,1.15484],[0.07901,1.1201],[0.08077,1.1129],[0.08825,1.07742],[0.08836,1.07673],[0.09573,1.03226],[0.09585,1.0317],[0.1052,0.99622],[0.10694,0.99032],[0.11455,0.96302],[0.11814,0.94839],[0.12203,0.92988],[0.12749,0.90323],[0.13136,0.88596],[0.14243,0.84194],[0.14443,0.8351],[0.15363,0.80323],[0.1631,0.75565],[0.16485,0.74839],[0.17243,0.72366],[0.17978,0.70323],[0.18176,0.69726],[0.18911,0.67419],[0.19482,0.6599],[0.20403,0.63871],[0.2116,0.62124],[0.22081,0.6],[0.22092,0.59974],[0.23584,0.56662],[0.24504,0.54839],[0.25448,0.53382],[0.26367,0.52258],[0.27125,0.5124],[0.28417,0.49355],[0.30105,0.4699],[0.30839,0.46129],[0.33457,0.43991],[0.33631,0.43871],[0.36436,0.42226],[0.37354,0.41935],[0.396,0.41844],[0.41447,0.41935],[0.42763,0.41849],[0.45355,0.41613],[0.4574,0.41638],[0.48516,0.42581],[0.49087,0.42818],[0.51319,0.43726],[0.53166,0.44516],[0.54107,0.44969],[0.56327,0.46452],[0.57268,0.47355],[0.58743,0.49032],[0.59869,0.50433],[0.60601,0.5129],[0.6247,0.5342],[0.63017,0.54194],[0.64142,0.56436],[0.64688,0.57742],[0.65813,0.60035],[0.66359,0.60968],[0.67855,0.63307],[0.68588,0.64516],[0.6934,0.65877],[0.70639,0.68597],[0.70816,0.69032],[0.71752,0.71547],[0.72301,0.72581],[0.73608,0.74288],[0.75088,0.76129],[0.75276,0.76401],[0.7676,0.79355],[0.7676,0.79357],[0.78059,0.82258],[0.78244,0.82638],[0.78985,0.84139],[0.80101,0.86452],[0.80655,0.87671],[0.81958,0.90645],[0.82326,0.9146],[0.83996,0.94814],[0.84186,0.95161],[0.85481,0.97425],[0.87158,1.00323],[0.87708,1.0133],[0.89386,1.04516],[0.89752,1.05173],[0.91423,1.07915],[0.92172,1.09032],[0.94768,1.12577],[0.95517,1.13548],[0.97932,1.16452],[0.98113,1.16649],[1.00902,1.19573],[1.0165,1.20323],[1.04621,1.23082],[1.05181,1.23548],[1.06666,1.24665],[1.08528,1.25806],[1.10013,1.26575],[1.12247,1.27742],[1.13361,1.28481],[1.14478,1.29032],[1.17081,1.296],[1.17268,1.29677],[1.1764,1.30323],[1.19313,1.30195],[1.20431,1.30323],[1.22848,1.31822],[1.23034,1.31935],[1.2508,1.32258],[1.26382,1.32515],[1.28242,1.32903],[1.28614,1.3296],[1.31963,1.33215],[1.32707,1.33226],[1.34568,1.33208],[1.368,1.33226],[1.37172,1.33255],[1.39962,1.33548],[1.41451,1.33529],[1.44427,1.33548],[1.46846,1.33825],[1.50008,1.34194],[1.528,1.34216],[1.55217,1.34194],[1.6024,1.34516],[1.60614,1.34514],[1.64892,1.34194],[1.66939,1.34148],[1.70473,1.34194],[1.71404,1.34203],[1.74938,1.34194],[1.76241,1.34192],[1.80334,1.34194],[1.81264,1.34191],[1.85357,1.34189],[1.85915,1.34194],[1.90008,1.34194],[1.94101,1.33904],[1.9466,1.33871],[1.97636,1.33852],[1.98194,1.33871]]
    }
    // y values of the series
    const series = ref([object1]);

		const handleClick = () => {
			data.value = data.value.map((item) => {
				let object = item.map((string) => {
					return Number(string)
				})
				return object
			})
			showChart.value = true
			console.log(JSON.stringify(data.value))
			// json = json.replaceAll('[', '{')
			// json = json.replaceAll(']', '}')
			// json = json.replaceAll('"', '')
			// json = json.replace('{', '[')
			// json = json.replace(/}$/, ']')
		}

		return {
			onFileUpload,
			chartOptions,
			series,
			data,
			handleClick,
			showChart
		}
	}
}
</script>

<style>

</style>